<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="r">
	<!-- 공연 검색 -->
	<select id="getReple" parameterType="String" resultType="reple">
		select * from reple where play_id = #{play_id}
	</select>
	
	<!-- 작성자 검색 -->
	<select id="getUser" parameterType="String" resultType="reple">
		select * from reple where user_id = #{user_id}, reple_contents = ${reple_contents}
	</select>
	
	<!-- 후기 추가 -->
	<insert id="insertReple" parameterType="reple">
		INSERT INTO reple VALUES(reple_no_seq.nextVal, #{play_id}, #{user_id}, #{reple_contents},
		#{reple_rating}, sysdate, 0, 0)
	</insert>

	<!-- 내 공연후기 검색 -->
	<select id="getMyReple" parameterType="String" resultType="reple">
		select r.*, p.play_prfnm from reple r, play p where r.user_id = #{user_id} and r.play_id = p.play_id
	</select>
	
	<!-- 내 리플 개수 세기 -->
	<select id="reple_u_count" resultType="int" parameterType="String">
		select count(*) from reple where user_id = #{user_id} and REPLE_REMOVE_LEV = 0
	</select>
</mapper>












